#include <iostream>
#include <thread>
#include <mutex>
#include <memory>
#include <vector>
#include <chrono>
#include <cstring>
#include <atomic>

// ============================================================================
// Р‘Р•Р—РћРџРђРЎРќР«Р• РђР›Р¬РўР•Р РќРђРўРР’Р« saga
// ============================================================================

// TODO: Р”РѕР±Р°РІРёС‚СЊ РєРѕРјРјРµРЅС‚Р°СЂРёРё РЅР° СЂСѓСЃСЃРєРѕРј СЏР·С‹РєРµ
// TODO: РЎРѕР·РґР°С‚СЊ РґРѕРїРѕР»РЅРёС‚РµР»СЊРЅС‹Рµ Р±РµР·РѕРїР°СЃРЅС‹Рµ РІР°СЂРёР°РЅС‚С‹
// TODO: Р”РѕР±Р°РІРёС‚СЊ С‚РµСЃС‚С‹ Р±РµР·РѕРїР°СЃРЅРѕСЃС‚Рё

// ----------------------------------------------------------------------------
// Р‘Р•Р—РћРџРђРЎРќРђРЇ РђР›Р¬РўР•Р РќРђРўРР’Рђ 1: [РќРђР—Р’РђРќРР• РџРћР”РҐРћР”Рђ]
// ----------------------------------------------------------------------------

class SecuresagaV1 {
private:
    // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Рµ РїСЂРёРІР°С‚РЅС‹Рµ С‡Р»РµРЅС‹
    mutable std::mutex data_mutex;
    
    SecuresagaV1() {
        // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Р№ РєРѕРЅСЃС‚СЂСѓРєС‚РѕСЂ
        std::cout << "SecuresagaV1 СЃРѕР·РґР°РЅ РІ РїРѕС‚РѕРєРµ " << std::this_thread::get_id() << std::endl;
    }
    
public:
    // РЈРґР°Р»СЏРµРј РєРѕРїРёСЂРѕРІР°РЅРёРµ Рё РїСЂРёСЃРІР°РёРІР°РЅРёРµ
    SecuresagaV1(const SecuresagaV1&) = delete;
    SecuresagaV1& operator=(const SecuresagaV1&) = delete;
    
    // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Рµ РјРµС‚РѕРґС‹
    
    ~SecuresagaV1() {
        // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Р№ РґРµСЃС‚СЂСѓРєС‚РѕСЂ
        std::cout << "SecuresagaV1 СѓРЅРёС‡С‚РѕР¶РµРЅ" << std::endl;
    }
};

// ----------------------------------------------------------------------------
// Р‘Р•Р—РћРџРђРЎРќРђРЇ РђР›Р¬РўР•Р РќРђРўРР’Рђ 2: [РќРђР—Р’РђРќРР• РџРћР”РҐРћР”Рђ]
// ----------------------------------------------------------------------------

class SecuresagaV2 {
private:
    // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Рµ РїСЂРёРІР°С‚РЅС‹Рµ С‡Р»РµРЅС‹
    
    SecuresagaV2() {
        // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Р№ РєРѕРЅСЃС‚СЂСѓРєС‚РѕСЂ
        std::cout << "SecuresagaV2 СЃРѕР·РґР°РЅ РІ РїРѕС‚РѕРєРµ " << std::this_thread::get_id() << std::endl;
    }
    
public:
    // РЈРґР°Р»СЏРµРј РєРѕРїРёСЂРѕРІР°РЅРёРµ Рё РїСЂРёСЃРІР°РёРІР°РЅРёРµ
    SecuresagaV2(const SecuresagaV2&) = delete;
    SecuresagaV2& operator=(const SecuresagaV2&) = delete;
    
    // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Рµ РјРµС‚РѕРґС‹
    
    ~SecuresagaV2() {
        // TODO: Р”РѕР±Р°РІРёС‚СЊ Р±РµР·РѕРїР°СЃРЅС‹Р№ РґРµСЃС‚СЂСѓРєС‚РѕСЂ
        std::cout << "SecuresagaV2 СѓРЅРёС‡С‚РѕР¶РµРЅ" << std::endl;
    }
};

// ----------------------------------------------------------------------------
// Р‘Р•Р—РћРџРђРЎРќРђРЇ РђР›Р¬РўР•Р РќРђРўРР’Рђ 3: [РќРђР—Р’РђРќРР• РџРћР”РҐРћР”Рђ]
// ----------------------------------------------------------------------------

class Alternativesaga {
private:
    // TODO: Р”РѕР±Р°РІРёС‚СЊ РїСЂРёРІР°С‚РЅС‹Рµ С‡Р»РµРЅС‹ Р°Р»СЊС‚РµСЂРЅР°С‚РёРІРЅРѕРіРѕ РїРѕРґС…РѕРґР°
    
public:
    Alternativesaga() {
        // TODO: Р”РѕР±Р°РІРёС‚СЊ РєРѕРЅСЃС‚СЂСѓРєС‚РѕСЂ
        std::cout << "Alternativesaga СЃРѕР·РґР°РЅ" << std::endl;
    }
    
    // РЈРґР°Р»СЏРµРј РєРѕРїРёСЂРѕРІР°РЅРёРµ Рё РїСЂРёСЃРІР°РёРІР°РЅРёРµ
    Alternativesaga(const Alternativesaga&) = delete;
    Alternativesaga& operator=(const Alternativesaga&) = delete;
    
    // TODO: Р”РѕР±Р°РІРёС‚СЊ РјРµС‚РѕРґС‹
    
    ~Alternativesaga() {
        // TODO: Р”РѕР±Р°РІРёС‚СЊ РґРµСЃС‚СЂСѓРєС‚РѕСЂ
        std::cout << "Alternativesaga СѓРЅРёС‡С‚РѕР¶РµРЅ" << std::endl;
    }
};

// ----------------------------------------------------------------------------
// Р”Р•РњРћРќРЎРўР РђР¦РРЇ Р‘Р•Р—РћРџРђРЎРќР«РҐ РђР›Р¬РўР•Р РќРђРўРР’
// ----------------------------------------------------------------------------

void demonstrateSecuresagaV1() {
    std::cout << "\n=== Р”Р•РњРћРќРЎРўР РђР¦РРЇ SecuresagaV1 ===" << std::endl;
    
    // TODO: Р”РѕР±Р°РІРёС‚СЊ РґРµРјРѕРЅСЃС‚СЂР°С†РёСЋ РїРµСЂРІРѕР№ Р±РµР·РѕРїР°СЃРЅРѕР№ Р°Р»СЊС‚РµСЂРЅР°С‚РёРІС‹
    
    std::cout << "SecuresagaV1 РїСЂРѕРґРµРјРѕРЅСЃС‚СЂРёСЂРѕРІР°РЅ" << std::endl;
}

void demonstrateSecuresagaV2() {
    std::cout << "\n=== Р”Р•РњРћРќРЎРўР РђР¦РРЇ SecuresagaV2 ===" << std::endl;
    
    // TODO: Р”РѕР±Р°РІРёС‚СЊ РґРµРјРѕРЅСЃС‚СЂР°С†РёСЋ РІС‚РѕСЂРѕР№ Р±РµР·РѕРїР°СЃРЅРѕР№ Р°Р»СЊС‚РµСЂРЅР°С‚РёРІС‹
    
    std::cout << "SecuresagaV2 РїСЂРѕРґРµРјРѕРЅСЃС‚СЂРёСЂРѕРІР°РЅ" << std::endl;
}

void demonstrateAlternativesaga() {
    std::cout << "\n=== Р”Р•РњРћРќРЎРўР РђР¦РРЇ Alternativesaga ===" << std::endl;
    
    // TODO: Р”РѕР±Р°РІРёС‚СЊ РґРµРјРѕРЅСЃС‚СЂР°С†РёСЋ Р°Р»СЊС‚РµСЂРЅР°С‚РёРІРЅРѕРіРѕ РїРѕРґС…РѕРґР°
    
    std::cout << "Alternativesaga РїСЂРѕРґРµРјРѕРЅСЃС‚СЂРёСЂРѕРІР°РЅ" << std::endl;
}

// ----------------------------------------------------------------------------
// РћРЎРќРћР’РќРђРЇ Р¤РЈРќРљР¦РРЇ
// ----------------------------------------------------------------------------

int main() {
    std::cout << "=== Р”Р•РњРћРќРЎРўР РђР¦РРЇ Р‘Р•Р—РћРџРђРЎРќР«РҐ РђР›Р¬РўР•Р РќРђРўРР’ saga ===" << std::endl;
    
    // Р”РµРјРѕРЅСЃС‚СЂР°С†РёСЏ СЂР°Р·Р»РёС‡РЅС‹С… Р±РµР·РѕРїР°СЃРЅС‹С… СЂРµР°Р»РёР·Р°С†РёР№
    demonstrateSecuresagaV1();
    demonstrateSecuresagaV2();
    demonstrateAlternativesaga();
    
    std::cout << "\n=== Р Р•РљРћРњР•РќР”РђР¦РР РџРћ Р‘Р•Р—РћРџРђРЎРќРћРЎРўР ===" << std::endl;
    std::cout << "1. TODO: Р”РѕР±Р°РІРёС‚СЊ РєРѕРЅРєСЂРµС‚РЅС‹Рµ СЂРµРєРѕРјРµРЅРґР°С†РёРё РґР»СЏ РґР°РЅРЅРѕРіРѕ РїР°С‚С‚РµСЂРЅР°" << std::endl;
    std::cout << "2. TODO: Р РµРєРѕРјРµРЅРґР°С†РёРё РїРѕ Р±РµР·РѕРїР°СЃРЅРѕРјСѓ РїСЂРѕРіСЂР°РјРјРёСЂРѕРІР°РЅРёСЋ" << std::endl;
    std::cout << "3. TODO: Р›СѓС‡С€РёРµ РїСЂР°РєС‚РёРєРё" << std::endl;
    std::cout << "4. TODO: РРЅСЃС‚СЂСѓРјРµРЅС‚С‹ Р°РЅР°Р»РёР·Р°" << std::endl;
    
    return 0;
}

